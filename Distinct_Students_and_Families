CREATE TABLE all_basis_families
(in_fam INT,
school TEXT,
school_id INT,
school_year TEXT,
indicator_id INT,
family_id TEXT,
school_fam_id TEXT,
OG_family_name TEXT,
family_first_name TEXT,
family_last_name TEXT,
family_full_name TEXT,
OG_student_name TEXT,
student_first_name TEXT,
student_last_name TEXT,
student_full_name TEXT,
student_grade TEXT,
student_code TEXT,
OG_billing_item TEXT,
billing_prefix TEXT,
billing_without_prefix TEXT,
billing_item TEXT,
billing_type TEXT,
months_billed TEXT,
times_billed INT,
months_paid TEXT,
times_paid INT,
total_billed FLOAT,
total_paid FLOAT,
total_unapplied FLOAT,
billed_minus_paid FLOAT,
total_aug_2 FLOAT,
total_sep_2 FLOAT,
start_yr_01_billed FLOAT,
start_yr_01_paid FLOAT,
start_yr_02_billed FLOAT,
start_yr_02_paid FLOAT,
start_yr_03_billed FLOAT,
start_yr_03_paid FLOAT,
start_yr_04_billed FLOAT,
start_yr_04_paid FLOAT,
start_yr_05_billed FLOAT,
start_yr_05_paid FLOAT,
start_yr_06_billed FLOAT,
start_yr_06_paid FLOAT,
start_yr_07_billed FLOAT,
start_yr_07_paid FLOAT,
start_yr_08_billed FLOAT,
start_yr_08_paid FLOAT,
start_yr_09_billed FLOAT,
start_yr_09_paid FLOAT,
start_yr_10_billed FLOAT,
start_yr_10_paid FLOAT,
start_yr_11_billed FLOAT,
start_yr_11_paid FLOAT,
start_yr_12_billed FLOAT,
start_yr_12_paid FLOAT,
end_yr_01_billed FLOAT,
end_yr_01_paid FLOAT,
end_yr_02_billed FLOAT,
end_yr_02_paid FLOAT,
end_yr_03_billed FLOAT,
end_yr_03_paid FLOAT,
end_yr_04_billed FLOAT,
end_yr_04_paid FLOAT,
end_yr_05_billed FLOAT,
end_yr_05_paid FLOAT,
end_yr_06_billed FLOAT,
end_yr_06_paid FLOAT,
end_yr_07_billed FLOAT,
end_yr_07_paid FLOAT,
end_yr_08_billed FLOAT,
end_yr_08_paid FLOAT,
end_yr_09_billed FLOAT,
end_yr_09_paid FLOAT,
end_yr_10_billed FLOAT,
aug_02 FLOAT,
sep_02 FLOAT,
unapplied FLOAT)





INSERT INTO all_basis_families
(in_fam,
school,
school_id,
school_year,
indicator_id,
family_id,
school_fam_id,
OG_family_name,
family_first_name,
family_last_name,
family_full_name,
OG_student_name,
student_first_name,
student_last_name,
student_full_name,
student_grade,
student_code,
OG_billing_item,
billing_prefix,
billing_without_prefix,
billing_item,
billing_type,
months_billed,
times_billed,
months_paid,
times_paid,
total_billed,
total_paid,
total_unapplied,
billed_minus_paid,
total_aug_2,
total_sep_2,
start_yr_01_billed,
start_yr_01_paid,
start_yr_02_billed,
start_yr_02_paid,
start_yr_03_billed,
start_yr_03_paid,
start_yr_04_billed,
start_yr_04_paid,
start_yr_05_billed,
start_yr_05_paid,
start_yr_06_billed,
start_yr_06_paid,
start_yr_07_billed,
start_yr_07_paid,
start_yr_08_billed,
start_yr_08_paid,
start_yr_09_billed,
start_yr_09_paid,
start_yr_10_billed,
start_yr_10_paid,
start_yr_11_billed,
start_yr_11_paid,
start_yr_12_billed,
start_yr_12_paid,
end_yr_01_billed,
end_yr_01_paid,
end_yr_02_billed,
end_yr_02_paid,
end_yr_03_billed,
end_yr_03_paid,
end_yr_04_billed,
end_yr_04_paid,
end_yr_05_billed,
end_yr_05_paid,
end_yr_06_billed,
end_yr_06_paid,
end_yr_07_billed,
end_yr_07_paid,
end_yr_08_billed,
end_yr_08_paid,
end_yr_09_billed,
end_yr_09_paid,
end_yr_10_billed,
aug_02,
sep_02,
unapplied)
SELECT *
FROM(
SELECT  COUNT(*) AS in_fam,
		*
FROM
(SELECT *
FROM billing_and_paid_all
GROUP BY school_fam_id, student_full_name)
GROUP BY school_fam_id
ORDER BY in_fam DESC)

__________________________________________________________________________________________________________________________________________________________
__________________________________________________________________________________________________________________________________________________________
__________________________________________________________________________________________________________________________________________________________
__________________________________________________________________________________________________________________________________________________________
__________________________________________________________________________________________________________________________________________________________
__________________________________________________________________________________________________________________________________________________________
__________________________________________________________________________________________________________________________________________________________
__________________________________________________________________________________________________________________________________________________________
__________________________________________________________________________________________________________________________________________________________
__________________________________________________________________________________________________________________________________________________________
__________________________________________________________________________________________________________________________________________________________
__________________________________________________________________________________________________________________________________________________________






CREATE TABLE all_basis_students(
years_student INT,
school TEXT,
school_id INT,
school_year TEXT,
indicator_id INT,
family_id TEXT,
school_fam_id TEXT,
OG_family_name TEXT,
family_first_name TEXT,
family_last_name TEXT,
family_full_name TEXT,
OG_student_name TEXT,
student_first_name TEXT,
student_last_name TEXT,
student_full_name TEXT,
student_grade TEXT,
student_code TEXT,
OG_billing_item TEXT,
billing_prefix TEXT,
billing_without_prefix TEXT,
billing_item TEXT,
billing_type TEXT,
months_billed TEXT,
times_billed INT,
months_paid TEXT,
times_paid INT,
total_billed FLOAT,
total_paid FLOAT,
total_unapplied FLOAT,
billed_minus_paid FLOAT,
total_aug_2 FLOAT,
total_sep_2 FLOAT,
start_yr_01_billed FLOAT,
start_yr_01_paid FLOAT,
start_yr_02_billed FLOAT,
start_yr_02_paid FLOAT,
start_yr_03_billed FLOAT,
start_yr_03_paid FLOAT,
start_yr_04_billed FLOAT,
start_yr_04_paid FLOAT,
start_yr_05_billed FLOAT,
start_yr_05_paid FLOAT,
start_yr_06_billed FLOAT,
start_yr_06_paid FLOAT,
start_yr_07_billed FLOAT,
start_yr_07_paid FLOAT,
start_yr_08_billed FLOAT,
start_yr_08_paid FLOAT,
start_yr_09_billed FLOAT,
start_yr_09_paid FLOAT,
start_yr_10_billed FLOAT,
start_yr_10_paid FLOAT,
start_yr_11_billed FLOAT,
start_yr_11_paid FLOAT,
start_yr_12_billed FLOAT,
start_yr_12_paid FLOAT,
end_yr_01_billed FLOAT,
end_yr_01_paid FLOAT,
end_yr_02_billed FLOAT,
end_yr_02_paid FLOAT,
end_yr_03_billed FLOAT,
end_yr_03_paid FLOAT,
end_yr_04_billed FLOAT,
end_yr_04_paid FLOAT,
end_yr_05_billed FLOAT,
end_yr_05_paid FLOAT,
end_yr_06_billed FLOAT,
end_yr_06_paid FLOAT,
end_yr_07_billed FLOAT,
end_yr_07_paid FLOAT,
end_yr_08_billed FLOAT,
end_yr_08_paid FLOAT,
end_yr_09_billed FLOAT,
end_yr_09_paid FLOAT,
end_yr_10_billed FLOAT,
aug_02 FLOAT,
sep_02 FLOAT,
unapplied FLOAT)





INSERT INTO all_basis_students(
years_student,
school,
school_id,
school_year,
indicator_id,
family_id,
school_fam_id,
OG_family_name,
family_first_name,
family_last_name,
family_full_name,
OG_student_name,
student_first_name,
student_last_name,
student_full_name,
student_grade,
student_code,
OG_billing_item,
billing_prefix,
billing_without_prefix,
billing_item,
billing_type,
months_billed,
times_billed,
months_paid,
times_paid,
total_billed,
total_paid,
total_unapplied,
billed_minus_paid,
total_aug_2,
total_sep_2,
start_yr_01_billed,
start_yr_01_paid,
start_yr_02_billed,
start_yr_02_paid,
start_yr_03_billed,
start_yr_03_paid,
start_yr_04_billed,
start_yr_04_paid,
start_yr_05_billed,
start_yr_05_paid,
start_yr_06_billed,
start_yr_06_paid,
start_yr_07_billed,
start_yr_07_paid,
start_yr_08_billed,
start_yr_08_paid,
start_yr_09_billed,
start_yr_09_paid,
start_yr_10_billed,
start_yr_10_paid,
start_yr_11_billed,
start_yr_11_paid,
start_yr_12_billed,
start_yr_12_paid,
end_yr_01_billed,
end_yr_01_paid,
end_yr_02_billed,
end_yr_02_paid,
end_yr_03_billed,
end_yr_03_paid,
end_yr_04_billed,
end_yr_04_paid,
end_yr_05_billed,
end_yr_05_paid,
end_yr_06_billed,
end_yr_06_paid,
end_yr_07_billed,
end_yr_07_paid,
end_yr_08_billed,
end_yr_08_paid,
end_yr_09_billed,
end_yr_09_paid,
end_yr_10_billed,
aug_02,
sep_02,
unapplied)
SELECT  *
FROM
(SELECT COUNT(*) AS years_student,
		*
FROM billing_and_paid_all
GROUP BY school_fam_id, student_full_name)
ORDER BY years_student DESC







